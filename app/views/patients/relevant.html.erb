<h1>Patients with Upcoming Appointments</h1>

<%= form_with url: relevant_patients_path, method: :get, local: true do |form| %>
  <%= form.text_field :query, placeholder: 'Search by name or email', value: params[:query], class: 'form-control mb-3' %>
  <%= form.submit 'Search', class: 'btn btn-primary' %>
<% end %>

<%= link_to 'All Patients', patients_path, class: 'btn btn-secondary mb-3' %>

<table class="table table-striped">
  <thead>
    <tr>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Email</th>
      <th>Next Appointment</th>
    </tr>
  </thead>
  <tbody>
    <% @patients.each do |patient| %>
      <tr>
        <td><%= link_to patient.first_name, edit_patient_path(patient) %></td>
        <td><%= patient.last_name %></td>
        <td><%= patient.email %></td>
        <td><%= patient.next_appointment.present? ? l(patient.next_appointment, format: :long) : 'N/A' %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= paginate @patients %>
